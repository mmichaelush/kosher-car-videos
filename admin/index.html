<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ניהול תוכן - CAR-טיב</title>
  <link rel="icon" href="../data/assets/images/favicon.ico" type="image/x-icon">
  
  <!-- Netlify Identity Widget for authentication -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>
  <!-- Decap CMS main script -->
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
  
  <script>
    // --- The Final Solution: Inject CSS Directly into the Page ---
    
    // The entire content of admin-styles.css is now here, inside a string.
    const customCSS = `
      @import url('https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700&display=swap');

      /* Force font on the entire admin UI */
      html, body, button, input, textarea, select, div, span, p, h1, h2, h3, h4 {
          font-family: 'Rubik', sans-serif !important;
      }

      /* Style input fields and containers */
      [class*="ControlContainer-sc"], [class*="WidgetContainer-sc"] {
          border-radius: 8px !important;
          border: 1px solid #e2e8f0 !important;
          transition: all 0.2s ease-in-out !important;
          padding: 2px !important;
      }

      [class*="ControlContainer-sc"]:focus-within, 
      [class*="WidgetContainer-sc"]:focus-within,
      [class*="Editor-sc-"] [class*="Editor-focused-"] {
          border-color: #8B5CF6 !important;
          box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.25) !important;
      }

      /* Style all buttons */
      [class*="Button-sc-"] {
          border-radius: 8px !important;
          font-weight: 500 !important;
          transition: all 0.2s ease-in-out !important;
          padding: 10px 16px !important;
          border: none !important;
          text-transform: none !important;
      }

      /* Primary buttons (Save, Publish, etc.) */
      [class*="Button-sc-"][class*="Button-primary-"] {
          background-color: #6D28D9 !important;
          color: white !important;
      }
      [class*="Button-sc-"][class*="Button-primary-"]:hover {
          background-color: #5B21B6 !important;
      }

      /* Secondary/default buttons */
      [class*="Button-sc-"][class*="Button-default-"] {
          background-color: #f1f5f9 !important;
          color: #334155 !important;
      }

      /* Header of the collection view */
      [class*="CollectionTop-sc-"] {
          border-bottom: 2px solid #f1f5f9 !important;
          padding-bottom: 1.5rem !important;
      }

      /* Individual items in the collection list */
      [class*="StyledListItem-sc-"] {
          border-radius: 12px !important;
          margin-bottom: 0.75rem !important;
          border: 1px solid #e2e8f0 !important;
          transition: box-shadow 0.2s ease, border-color 0.2s ease !important;
      }

      [class*="StyledListItem-sc-"]:hover {
          border-color: #c7d2fe !important;
          box-shadow: 0 4px 10px rgba(0,0,0,0.05) !important;
      }

      /* The main editor card */
      [class*="Card-sc-"] {
           border-radius: 12px !important;
           box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1) !important;
           border: none !important;
           padding: 2rem !important;
           background-color: #ffffff !important;
      }

      /* Change the main background of the editor page */
      [class*="App-sc-"] {
          background-color: #f8fafc !important;
      }
    `;

    // Wait for the CMS to initialize, then inject the styles
    window.addEventListener('DOMContentLoaded', function() {
      // Create a <style> element
      var styleElement = document.createElement('style');
      styleElement.type = 'text/css';
      
      // Add the CSS rules to the <style> element
      styleElement.appendChild(document.createTextNode(customCSS));
      
      // Append the <style> element to the document's <head>
      document.head.appendChild(styleElement);
      console.log('Custom styles have been directly injected into the page.');
    });

    // --- Netlify Identity Login Flow ---
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on("init", user => {
        if (!user) {
          window.netlifyIdentity.on("login", () => {
            document.location.href = "/admin/";
          });
        }
      });
    }
  </script>
</body>
</html>
